<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">

<head th:replace="fragments/layout :: head"></head>

<body>

    <div id="wrapper">
        <div th:replace="fragments/layout :: sidebar"></div>
        <div id="page-content-wrapper">
            <nav th:replace="fragments/layout :: navbar"></nav>
            <div class="container-fluid my-4 px-4">
                <h2>Settings</h2>
                <div class="row mt-4">
                    <div class="col-md-8">

                        <!-- Appearance -->
                        <div class="card mb-4 shadow-sm">
                            <div class="card-header bg-light">
                                <i class="fas fa-paint-brush me-2"></i> Appearance
                            </div>
                            <div class="card-body">
                                <div class="form-check form-switch">
                                    <input class="form-check-input" type="checkbox" id="darkModeSwitch">
                                    <label class="form-check-label" for="darkModeSwitch">Enable Dark Mode</label>
                                </div>
                                <small class="text-muted">Toggles the application theme between Light and Dark.</small>
                            </div>
                        </div>

                        <!-- Preferences -->
                        <div class="card mb-4 shadow-sm">
                            <div class="card-header bg-light">
                                <i class="fas fa-globe me-2"></i> Preferences
                            </div>
                            <div class="card-body">
                                <div class="mb-3">
                                    <label for="currencySelect" class="form-label">Display Currency</label>
                                    <select id="currencySelect" class="form-select w-50">
                                        <option value="USD">USD ($)</option>
                                        <option value="EUR">EUR (€)</option>
                                        <option value="INR">INR (₹)</option>
                                        <option value="GBP">GBP (£)</option>
                                    </select>
                                    <div class="form-text">Choose your preferred currency symbol.</div>
                                </div>
                            </div>
                        </div>

                        <!-- System Categories (Read Only) -->
                        <div class="card mb-4 shadow-sm">
                            <div class="card-header bg-light">
                                <i class="fas fa-list me-2"></i> System Categories
                            </div>
                            <div class="card-body">
                                <div class="d-flex flex-wrap gap-2">
                                    <!-- We need to pass categories to this view if we want to show them -->
                                    <span class="badge bg-secondary p-2">Food</span>
                                    <span class="badge bg-secondary p-2">Transportation</span>
                                    <span class="badge bg-secondary p-2">Utilities</span>
                                    <span class="badge bg-secondary p-2">Entertainment</span>
                                    <span class="badge bg-secondary p-2">Health</span>
                                    <span class="badge bg-secondary p-2">Shopping</span>
                                    <span class="badge bg-secondary p-2">Housing</span>
                                </div>
                                <small class="text-muted mt-2 d-block">These are the standard categories available for
                                    budgets and expenses.</small>
                            </div>
                        </div>

                    </div>
                </div>
            </div>
        </div>
    </div>

    <div th:replace="fragments/layout :: scripts"></div>

    <script>
        $(document).ready(function () {
            // DARK MODE LOGIC
            const darkModeSwitch = $('#darkModeSwitch');
            const savedTheme = localStorage.getItem('theme');

            if (savedTheme === 'dark') {
                darkModeSwitch.prop('checked', true);
            }

            darkModeSwitch.change(function () {
                if ($(this).is(':checked')) {
                    $('body').addClass('dark-mode'); // We need to define this class in CSS
                    localStorage.setItem('theme', 'dark');
                } else {
                    $('body').removeClass('dark-mode');
                    localStorage.setItem('theme', 'light');
                }
            });

            // CURRENCY LOGIC
            const currencySelect = $('#currencySelect');
            const savedCurrency = localStorage.getItem('currency') || 'USD';
            currencySelect.val(savedCurrency);

            currencySelect.change(function () {
                localStorage.setItem('currency', $(this).val());
                alert('Currency preference saved! Future improvements will update all symbols.');
            });
        });

        // Helper to apply basic styles immediately (though typically this goes in global script)
        function applyTheme(theme) {
            if (theme === 'dark') {
                document.body.style.backgroundColor = '#121212';
                document.body.style.color = '#ffffff';
                // Add more overrides here or simpler: toggle a class on body and have CSS handle it
                document.body.classList.add('bg-dark', 'text-white');
                $('.card').addClass('bg-dark text-white border-secondary');
                $('.card-header').addClass('bg-secondary text-white border-secondary');
                $('.table').addClass('table-dark');
            } else {
                document.body.style.backgroundColor = '#f8f9fa';
                document.body.style.color = '#212529';
                document.body.classList.remove('bg-dark', 'text-white');
                $('.card').removeClass('bg-dark text-white border-secondary');
                $('.card-header').removeClass('bg-secondary text-white border-secondary');
                $('.table').removeClass('table-dark');
            }
        }
    </script>
</body>

</html>